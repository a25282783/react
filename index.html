<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hi,react</title>
    <!-- <script src="node_modules/react/umd/react.development.js"></script>
    <script src="node_modules/react-dom/umd/react-dom.development.js"></script>
    <script src="node_modules/babel-standalone/babel.min.js"></script> -->
    <script crossorigin src="https://unpkg.com/react@17/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@17/umd/react-dom.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/babel-standalone@6/babel.min.js"></script>
    <style>
        .c-g{
            color: green;
        }
    </style>
</head>
<body>
    <div id="testjsx_js"></div>
    <div id="demo"></div>
    <div id="demo2"></div>
    <div id="demo3"></div>
    <div id="demo4"></div>
</body>
<!-- vscode 下載 Live Server 以免cors-->
<script src="js/jsx.js" type="text/babel"></script>
<script type="text/babel">
    // JSX 必須加type="text/babel" 
    let text = "jason"
    let age = 10
    var arr = [
        <li>li</li>,
        <li>li</li>
    ]
    var arr2 = [
        "吃飯",
        "睡覺",
        "打咚咚"
    ]
    var obj = {
        a:"吃飯",
        b:"睡覺",
        c:"打咚咚"
    }

    // background-color -> backgroundColor
    let c_r = {color:"red",border:"1px solid black",backgroundColor:"yellow"}
    let dom1 = 
        //必須要父標籤包裹
        <div>
            <h1>
            hello
            {/*我是注釋*/}
            </h1>
            {/*使用表達式,用{}*/}
            <div>
                my name is {text},age is {age+1}
            </div>
            {/*引用js/jsx.js*/}
            <div>
                my name is {intro({name:"AAAA"})}
            </div>
            {/*數組*/}
            <ul>
                {arr}
            </ul>
            {/*屬性設置*/}
            <span style={c_r}>屬性設置</span>
            {/*class -> className*/}
            <span className="c-g">c-g</span>
          
        </div>;
    /*列表 map ,在react中渲染數組要有唯一key值*/
    /*click事件 用箭頭函數*/
    let dom4 = arr2.map((item,index)=>{
                return <li key={index} onClick={(e)=>{
                    console.log(item)
                }}>{item}</li>
            })
    /*函數組件*/
    function CompA(){
        return <span>我是子組件</span>
    }
    /*porps 是組件對外接口，組件不能修改自身porps
    * return jsx 分行要加括號
    */
    function  Comp(props) {
        return (
            <div>我是無狀態組件
                <CompA/>
                <span className={props.className}>props:{props.msg}--default:{props.default}</span>
            </div>
        )
    }
    /*組件props默認值*/
    Comp.defaultProps={msg:"部會出現",default:"默認值"}
    /*類組件*/
    class ClassComp extends React.Component{
        render() {
            return (
                <div>
                    <span> 類組件</span>
                    <span className={this.props.className}>props:{this.props.msg}</span>
                </div>
            )
        }
    }

    let dom5 = <div>
        {
            /*遍歷物件*/
            Object.keys(obj).map((k,i)=>{
                return <span>key:{k}-----value:{obj[k]},</span>
            })
        }
        {/*組件必須大寫開頭*/}
        <Comp className="c-g" msg="hi,props"/>
        <Comp {...{className:"c-g",msg:"hi,props"}}/>
        <ClassComp className="c-g" msg="hi,props"/>
        <ClassComp {...{className:"c-g",msg:"hi,props"}}/>
        </div>

    // state 狀態
    // props 是組件對外的接口，state 是組件對內的接口
    // 主要區別:state可變，props只讀，如果想修改props中數據，則修改傳給當前組件數據的父組件
    // 狀態改變了，DOM自動更新
    // 如果要使用狀態，不能使用無狀態組件
    class Com extends React.Component{
        constructor(props){
            // 必須在super中寫上props
            super(props)
            // 定義state
            this.state={
                name:'哈哈',
                bool:true
            }
        }
        func = () =>{
            this.setState({bool:!this.state.bool})
        };
        render(){
            return (
                // 修改一定要調用this.setState({key:value},callback()) 異步
                <div>my name is {(this.state.bool)?'哈哈':'哭哭'}<button onClick={this.func}>click</button></div>
            )
        }
    }
    
    // 轉發refs 不能在無狀態組件使用
    // ref 使用方式
    // 1.字串
    // 2.回調
    // 3.React.createRef()
    class Com2 extends React.Component{
        func = () =>{
            alert(this.refs.input.value)
        };
        func2 = () =>{
            alert(this.input2.value)
        };
        render(){
            return (
                <div>
                    <Com/>
                    {/*字串*/}
                    <input type="text" placeholder="輸入" ref="input"/>
                    <button onClick={this.func}>click</button>
                    {/*回調*/}
                    <input type="text" placeholder="輸入" ref={(input2)=>{this.input2 = input2}}/>
                    <button onClick={this.func2}>click</button>
                </div>
            )
        }
    }

    // 事件處理 小駝峰命名 綁定函數不能加()否則立即執行
    class Com3 extends React.Component{
        constructor(props){
            super(props)
        }
        func(i,e){
            console.log(i,e,this)
        }
        func2=(i)=>{
            console.log(i,this)
        }
        func3=()=>{
            console.log('i',this)
        }
        render(){
            return (
                <div>
                    <Com2/>
                    <button onClick={(e)=>{this.func("按鈕1",e)}}>按鈕1</button>
                    <button onClick={this.func2.bind(this,"按鈕2")}>按鈕2</button>
                    <button onClick={this.func3}>按鈕2</button>
                </div>
            )
        }
    }

    // 共用數據，狀態提升
    class ComA extends React.Component{
        constructor(props){
            super(props)
        }
        render(){
            return (
                <div>
                    {this.props.text}  
                </div>
            )
        }
    }
    class ComB extends React.Component{
        constructor(props){
            super(props)
        }
        render(){
            return (
                <div>
                    {this.props.text}  
                </div>
            )
        }
    }
    class ComAB extends React.Component{
        constructor(props){
            super(props)
            this.state = {
                comtext:"text"
            }
        }
        func(){
            this.setState({
                comtext:"text2"
            })
        }
        render(){
            return (
                <div>
                    <ComA text={this.state.comtext} onClick={this.func}/>
                    <ComB text={this.state.comtext} onClick={this.func}/>    
                </div>
            )
        }
    }

    ReactDOM.render(dom1,document.getElementById('demo'));
    ReactDOM.render(dom4,document.getElementById('demo2'));
    ReactDOM.render(dom5,document.getElementById('demo3'));
    ReactDOM.render(<Com3/>,document.getElementById('demo4'));
</script>
</html>